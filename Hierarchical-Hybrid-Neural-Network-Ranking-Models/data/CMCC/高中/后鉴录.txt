丁丑，俞瑱在居庸关剽掠，居民窃走来告。上曰：“居庸关山路险峻，北平之襟喉，百人守之，万夫莫窥。今俞瑱得之，利为彼有，势在必取。譬之人家后户，岂容弃与寇盗？今乘其初至，又兼剽掠，民心未服，取之甚易；若纵之不取，彼增兵守之，后难取也。”乃命徐安往讨之，安攻拔其城，俞瑱走怀来，依宋忠。捷至，上曰：“使贼知固结人心，谨守是关，虽欲取之，岂能即破？今天以授予，不可失也。”乃令吴玉守之。
上语诸将曰：“宋忠拥兵怀来，居庸关有必争之势，因其未至，可先击之。”诸将皆曰：“贼众我寡，难与争锋，击之未便，宜固守以待其至。”上曰：“非公等所知。贼众新集，其心不一；宋忠轻躁寡谋，狠愎自用，乘其未定，击之必破。”
　　癸未，上率马步精锐八千，卷甲而进。甲申，至怀来。先是，获贼间谍，言宋忠诳北平将士云：降家皆为上所杀，委尸填满沟壑，宜为报仇。将士闻之，或信或否。
上知之，乃以其家人为前锋，用其旧日旗帜。众遥见旗帜，识其父兄子弟咸在，喜曰：“噫！我固无恙。是宋都督诳我也，几为所误！”遂倒戈来归。宋忠余众，仓皇列阵。未成，上麾师渡河，鼓噪直冲其阵。宋忠大败，奔入城。我师乘之而入，宋忠匿于厕，搜获之。并擒俞瑱，斩孙泰于阵，余众悉降。
诸将已得宋忠，颇有喜色，上曰：宋忠本庸材，以利口取给，谄谀奸恶，货赂得官，才掌兵柄，便尔骄纵，此辈荧惑小人，视之如狐鼠耳，区区胜之，何足喜也？诸将咸顿首称善。